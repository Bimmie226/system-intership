# UNDERSTANDING COMMAND-LINE BASICS

## Discussing Distributions

Trước khi tìm hiểu về shell, cần thảo luận về bản phân phối(distros). Các bản phân phối Linux đều có nhân Linux ở trung tâm, nhưng các tính năng xung quanh khác nhau, bao gồm cả sự khác biệt dòng lệnh

## Reaching A Shell

Sau khi bạn cài đặt hệ thống Linux hoặc môi trường ảo (distro), thiết lập và khởi động nó, thường có thể truy cập vào giao diện dòng lệnh (terminal) bằng cách nhấn `Ctrl + Alt + F2`, rồi đăng nhập bằng tài khoản người dùng.

## Exploring Your Linux Shell Options

Mặc dù Bash shell là loại phổ biến và được sử dụng nhiều nhất trong hầu hết các bản phân phối Linux, nhưng còn có một số loại shell khác:

- Bash
- Dash
- KornShell
- tcsh
- Z shell

**Listing 1.2**: Showing to which	shell	`/bin/sh ` points	on an Ubuntu distribution
```bash
root@dev-server:~# readlink /bin/sh
dash
```

**Listing 1.3**: Displaying	the	current	shell	on a Ubuntu distribution
```bash
root@dev-server:~# echo $BASH_VERSION
5.0.17(1)-release
```

`echo $BASH_VERSION`: Hiển thị phiên bản của Bash Shell đang dùng hiện tại.

```bash
root@dev-server:~# uname -a
Linux dev-server 5.4.0-216-generic #236-Ubuntu SMP Fri Apr 11 19:53:21 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux
```

`uname`: Hiển thị thông tin chi tiết về hệ điều hành và kernel.
`-a`: Hiển thị tất cả thông tin có thể:
- Tên kernel
- Tên máy chủ
- Phiên bản kernel
- Ngày biên dịch kernel
- Kiến trúc phần cứng(x86_64, ...)
- Tên hệ điều hành(GNU/Linux, ...)

## Using A Shell

Để chạy một chương trình từ shell, tại dòng lệnh bạn chỉ cần gõ tên lệnh, dùng đúng cú pháp, rồi nhấn Enter để thực thi.

**Listing 1.5**: Using the `echo` command
```bash
root@dev-server:~# echo cho toi khi nao ?
cho toi khi nao ?
```

### Quoting Metacharacters
Lệnh `echo` rất hữu ích để minh họa một tính năng quan trọng khác của shell: shell quoting – tức là cách trích dẫn hoặc xử lý các ký tự đặc biệt trong Bash.

Trong Bash, có nhiều ký tự đặc biệt có ý nghĩa riêng (gọi là `metacharacters`) như:

```markdown
* ? [ ] ' " \ $ ; & ( ) | ^ < >
```

**Listing 1.6**: Using the `echo` command with a `$` metacharacter

Ký tự `$` thường được dùng để chỉ biến (variable). Khi bạn dùng `$` trong lệnh `echo`, shell sẽ cố gắng lấy giá trị của biến đó và hiển thị ra màn hình.

```bash
root@dev-server:~# echo $SHELL
/bin/bash
```

-> Ở đây `$SHELL` là một biến hệ thống, nên kết quả in ra là đường dẫn đến shell hiện tại.

```bash
root@dev-server:~# echo It cost $1.00
It cost .00
```

-> Shell sẽ hiểu `$1` là một biến, nhưng vì nó không có giá trị nên chỉ in ra `.00`.

**Listing 1.7**: Using the `echo` command and shell	quoting	a	single	metacharacter

Để buộc shell không hiểu ký tự đặc biệt theo nghĩa riêng, mà chỉ in ra nguyên văn, ta dùng shell quoting.

Có 3 cách phổ biến:
1) Dùng dấu gạch chéo ngược(backslash `\`) -> dùng cho một ký tự
2) Dùng dấu nháy kép (" ") → cho phép một số ký tự đặc biệt
3) Dùng dấu nháy đơn (' ') → bảo toàn nguyên văn mọi ký tự bên trong

```bash
# Dùng backslash cho 1 ký tự đặc biệt

root@dev-server:~# echo It cost \$1.00
It cost $1.00
```

```bash
root@dev-server:~# echo "Is Bim's cat alive or dead?"
root@dev-server:~# Is Bim's cat alive or dead?

root@dev-server:~# echo 'Is Bim'"'"'s cat alive or dead?'
root@dev-server:~# Is Bim'"'"'s cat alive or dead?
```

## Navigating the Directory Structure
Toàn bộ hệ thống Linux được xem như một cây thư mục duy nhất, có thư mục gốc là `/` (root directory).

Mỗi user có home directory riêng (ví dụ: `/home/Bim`).

- Lệnh quan trọng:
  - `cd`: di chuyển đến thư mục khác.
  - `pwd`: in ra đường dẫn của thư mục hiện tại.

```bash
$ pwd
/home/Bim
$ cd /etc
$ pwd
/etc
```

- Một số lệnh tắt hữu ích của `cd`:
  - `cd` hoặc `cd ~` hoặc `cd $HOME` -> quay về thư mục home của user
  - `cd -` -> quay lại thư mục làm việc trước đó
  
  ```bash
  $ pwd
  /etc
  $ cd /var
  $ pwd
  /var
  $ cd -
  /etc
  $ pwd
  /etc
  ```

## Using Environment Variables
### Environment Variables
Environment variables lưu thông tin hệ thống cụ thể cho từng người dùng (như `HOME`, `PATH`, `USER`, `HOSTNAME`, …).

### Biến PATH và việc tìm lệnh
- `PATH` chứa danh sách thư mục (ngăn cách bằng `:`) mà shell sẽ tìm khi gõ tên lệnh.
```bash
echo $PATH
/usr/local/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin
```
- Nếu chương trình không nằm trong PATH, shell báo lỗi:
```bash
command not found
```
- Muốn chạy chương trình trong PATH -> phải ghi đường dẫn:
```bash
/home/Bim/hello.sh
Hello world
```

## GETTING HELP

Linux có hệ thống man pages (manual pages) — tài liệu hướng dẫn cho từng lệnh, được cài sẵn trong máy (không cần Internet).

```bash
man <command>
```

Ví dụ:
```bash
man uname
```
-> Mở tài liệu hướng dẫn cho lệnh `uname`.

Lịch sử lệnh(Command History):
- Xem lịch sử:
```bash
history
```
-> Hiển thị danh sách lệnh đã gõ, có số thứ tự:
```bash
915  echo $SHELL
916  history
917  export EDITOR=nano
920  /home/bin/hello.sh
```
- Chạy lại lệnh cũ:
  - Theo số thự tự:
  ```bash
  !920
  ```
  -> thực hiện lệnh số 920.
  - Lệnh gần nhất:
  ```bash
  !!
  ```

File lưu lịch sử lênh:
- Mỗi phiên Bash lưu lịch sử vào biến $HISTFILE, thường là:
```bash
echo $HISTFILE
/home/Bim/.bash_history
```
- File này chỉ lưu sau khi đăng xuất.